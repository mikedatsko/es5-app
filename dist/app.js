function Data(){this.create=function(e,t){return e=e||prompt("Key:"),t=t||prompt("Data:"),void 0===e?(console.error("No key"),!1):void 0===t?(console.error("No data"),!1):void localStorage.setItem(e,t)},this.read=function(e){if(void 0===e)return console.error("No data"),!1;var t=localStorage.getItem(e);return t||(console.error("No data"),!1)},this.update=function(e,t){return e=e||prompt("Key:"),t=t||prompt("Data:"),void 0===e?(console.error("No key"),!1):void 0===t?(console.error("No data"),!1):localStorage.getItem(e)?void localStorage.setItem(e,t):(console.error("No data found"),!1)},this.delete=function(e){return void 0===(e=e||prompt("Key:"))?(console.error("No key"),!1):localStorage.getItem(e)?void localStorage.removeItem(e):(console.error("No data found"),!1)}}function Events(){}function Markup(){}function getId(){for(var e="",t=0;t<6;t++)e+="abcdefghijklmnopqrstuvwxyz"[Math.floor(26*Math.random())];return e}function AddTodo(){var e=this,t=markup.create({className:"row",parent:"#todo_add"}),a=markup.create({className:"col-lg-12",parent:t}),o=markup.create({tag:"form",attrs:[{action:"javascript:void(0)"},{method:"POST"}],parent:a}),n=markup.create({className:"input-group",parent:o}),r=markup.create({tag:"input",attrs:[{type:"text"},{placeholder:"Todo text..."}],className:"form-control",parent:n}),c=markup.create({tag:"span",className:"input-group-btn",parent:n}),s=markup.create({tag:"button",attrs:[{type:"submit"}],content:"Add",className:"btn btn-primary",parent:c});events.on(o,"submit",function(t){t.preventDefault(),e.add(o,r,s)}),events.subscribe("edit-todo-item",function(t){var a=t.detail;a.todo&&e.edit(o,r,s,a)})}function ListTodos(){var e=data.read("todos");e||(e=[],data.update("todos",JSON.stringify(e)));var t=this;events.subscribe("get-todos-list",function(){t.getList()})}function App(){listTodos.getList()}var data=new Data;Events.prototype.on=function(e,t,a){e.addEventListener(t,a,!1)},Events.prototype.subscribe=function(e,t){document.addEventListener(e,t,!1)},Events.prototype.send=function(e,t){t=t||{};var a=new CustomEvent(e,{detail:t});document.dispatchEvent(a)},Events.prototype.deleteEvent=function(){document.removeEventListener(eventName,callback,!1)};var events=new Events;Markup.prototype.create=function(e){var t={tag:"div",content:"",parent:"body",className:"",id:"",callback:void 0,attrs:[]};e=e||{};for(var a in t)e.hasOwnProperty(a)||(e[a]=t[a]);var o;if("input#checkbox"===e.tag?(o=document.createElement("input"),o.type="checkbox",o.value=1):o=document.createElement(e.tag),o.innerHTML=e.content,e.className&&(o.className+=e.className),e.id&&(o.id=e.id),"form"===e.tag&&(o.action="javascript:void(0)",o.method="post"),e.attrs.length&&e.attrs.forEach(function(e){for(var t in e)o[t]=e[t]}),e.parent){var n="string"==typeof e.parent?document.querySelector(e.parent):e.parent;if(!n)return console.error("No element found"),!1;n.appendChild(o)}else document.body.appendChild(o);return o},Markup.prototype.update=function(e,t){this.find(e)[0].innerHTML=t},Markup.prototype.delete=function(e){this.find(e)[0].remove()},Markup.prototype.find=function(e){return document.querySelectorAll(e)};var markup=new Markup;AddTodo.prototype.add=function(e,t,a){var o=data.read("todos");o?o=JSON.parse(o):(o=[],data.create("todos",JSON.stringify([]))),e.type&&"save"===e.type.value&&e.index?(o[+e.index.value].text=t.value,e.type.remove(),e.index.remove()):o.push({text:t.value,checked:!1}),a.innerHTML="Add",data.update("todos",JSON.stringify(o)),e.reset(),events.send("get-todos-list")},AddTodo.prototype.edit=function(e,t,a,o){if(e.type)e.type.value="save";else{markup.create({tag:"input",attrs:[{type:"hidden"},{name:"type"},{value:"save"}],className:"form-control",parent:e})}if(e.index)e.index.value=o.index;else{markup.create({tag:"input",attrs:[{type:"hidden"},{name:"index"},{value:o.index}],className:"form-control",parent:e})}a.innerHTML="Save",t.value=o.todo.text};var addTodo=new AddTodo;ListTodos.prototype.getList=function(){var e=this,t=data.read("todos");t=JSON.parse(t);var a=document.getElementById("todo_items");a.innerHTML="";var o=markup.create({tag:"tbody",parent:a});if(!t.length)return!1;t.forEach(function(a,n){var r=markup.create({tag:"tr",parent:o,className:a.checked?"success":""}),c=markup.create({tag:"td",parent:r,attrs:[{width:"30"}]}),s=markup.create({tag:"td",parent:r,content:a.text,className:a.checked?"checked":""}),d=markup.create({tag:"td",parent:r,attrs:[{width:"70"}]}),i=markup.create({tag:"span",className:"glyphicon glyphicon-"+(a.checked?"check":"unchecked"),parent:c}),p=markup.create({tag:"button",attrs:[{type:"button"}],className:"btn btn-info btn-xs",content:'<span class="glyphicon glyphicon-pencil"></span>',parent:d}),u=markup.create({tag:"button",attrs:[{type:"button"}],className:"btn btn-danger btn-xs",content:'<span class="glyphicon glyphicon-remove"></span>',parent:d});events.on(c,"click",function(o){o.preventDefault(),e.doCheck(r,i,s,t,a,n)}),events.on(s,"click",function(o){o.preventDefault(),e.doCheck(r,i,s,t,a,n)}),events.on(u,"click",function(a){e.delete(n,t)}),events.on(p,"click",function(e){events.send("edit-todo-item",{todo:a,index:n})})})},ListTodos.prototype.doCheck=function(e,t,a,o,n,r){"glyphicon glyphicon-check"===t.className?(e.className="",t.className="glyphicon glyphicon-unchecked",a.className="",n.checked=!1):(e.className="success",t.className="glyphicon glyphicon-check",a.className="checked",n.checked=!0),o[r]=n,data.update("todos",JSON.stringify(o)),events.send("get-todos-list")},ListTodos.prototype.delete=function(e,t){t.splice(e,1),data.update("todos",JSON.stringify(t)),events.send("get-todos-list")};var listTodos=new ListTodos,app=new App;
//# sourceMappingURL=app.js.map
